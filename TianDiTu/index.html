<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Use correct character set. -->
  <meta charset="utf-8">
  <!-- Tell IE to use the latest, best version. -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
  <meta name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <title>Load TianDiTu tile</title>
  <script src="../Build/Cesium/Cesium.js"></script>
  <style>
    @import url(../Build/Cesium/Widgets/widgets.css);

    html,
    body,
    #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    /* #baseLayerPickerContainer {
      position: absolute;
      top: 20px;
      right: 20px;
    } */
  </style>
</head>

<body>
  <div id="cesiumContainer">
    <!-- <div id="baseLayerPickerContainer"></div> -->
  </div>
  <script>
    let buildTDtLayer = id => new Cesium.WebMapTileServiceImageryProvider({
      url: `http://t4.tianditu.gov.cn/DataServer?T=${id}&x={TileCol}&y={TileRow}&l={TileMatrix}&tk=589dbed159ae6d3db6dbe8748587a947`,
      layer: id,
      style: 'default',
      format: 'image/png',
      tileMatrixSetID: 'w',
      maximumLevel: 19,
    });

    let baseProviderViewModel = new Cesium.ProviderViewModel({
      "name": "tianDiTu_vector",
      "tooltip": "天地图矢量地图服务",
      "iconUrl": Cesium.buildModuleUrl('Widgets/Images/ImageryProviders/openStreetMap.png'),
      "creationFunction": function () {
        return [buildTDtLayer("vec_w"), buildTDtLayer("cva_w")]
      }
    });

    let imgProviderViewModel = new Cesium.ProviderViewModel({
      "name": "tianDiTu_satellite",
      "tooltip": "天地图影像地图服务",
      "iconUrl": Cesium.buildModuleUrl('Widgets/Images/ImageryProviders/mapboxSatellite.png'),
      "creationFunction": function () {
        return [buildTDtLayer("img_w"), buildTDtLayer("cia_w")]
      }
    });

    let terrainProviderViewModel = new Cesium.ProviderViewModel({
      "name": "tianDiTu_terrain",
      "tooltip": "天地图地形地图服务",
      "iconUrl": Cesium.buildModuleUrl('Widgets/Images/ImageryProviders/mapboxTerrain.png'),
      "creationFunction": function () {
        return [buildTDtLayer("ter_w"), buildTDtLayer("cta_w")]
      }
    });

    let imageryViewModels = [baseProviderViewModel, imgProviderViewModel, terrainProviderViewModel];

    let option = {
      geocoder: false,
      homeButton: true,
      sceneModePicker: true,
      baseLayerPicker: true,
      navigationHelpButton: false,
      animation: false,
      // skyAtmosphere : false,
      // creditContainer: "credit",
      // imageryProvider : tdtBaseLayer,
      imageryProviderViewModels: imageryViewModels,
      selectedImageryProviderViewModel: imgProviderViewModel,
      timeline: false,
      fullscreenButton: true,
      vrButton: false
    };
    let viewer = new Cesium.Viewer('cesiumContainer', option);
    // let globe = viewer._cesiumWidget.scene.globe;

    // var baseLayerPicker = new Cesium.BaseLayerPicker('baseLayerPickerContainer', {
    //     globe : globe,
    //     imageryProviderViewModels : imageryViewModels
    // });
    // viewer.imageryLayers.addImageryProvider(tdtBaseLayer);
    // viewer.imageryLayers.addImageryProvider(tdtLabelLayer);
    viewer.camera.flyTo({
      destination: Cesium.Cartesian3.fromDegrees(118.7969, 32.0603, 800000)
    })
  </script>
</body>

</html>